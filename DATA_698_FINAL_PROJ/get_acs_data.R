library(tidycensus)
library(tigris, options(tigris_use_cache = TRUE))
library(sf)
library(tidyverse)
library(dplyr)

# insert census API key below
# census_api_key("<your_key>", install = TRUE)

readRenviron("~/.Renviron")

# load ACS data
census_ny_tracts <- get_acs(geography = "tract",
                     variables = c(total_pop = "B01001_001",
                                   total_male = "B01001_002",
                                   male_18to19 = "B01001_007",
                                   male_20 = "B01001_008",
                                   male_21 = "B01001_009",
                                   male_22to24 = "B01001_010",
                                   male_25to29 = "B01001_011",
                                   male_30to34 = "B01001_012",
                                   male_35to39 = "B01001_013",
                                   male_40to44 = "B01001_014",
                                   male_45to49 = "B01001_015",
                                   male_50to54 = "B01001_016",
                                   male_55to59 = "B01001_017",
                                   male_60to64 = "B01001_018",
                                   male_65to66 = "B01001_019",
                                   male_67to69 = "B01001_020",
                                   male_70to74 = "B01001_021",
                                   male_75to79 = "B01001_022",
                                   male_80to84 = "B01001_023",
                                   male_85_up = "B01001_024",
                                   female_18to19 = "B01001_031",
                                   female_20 = "B01001_032",
                                   female_21 = "B01001_033",
                                   female_22to24 = "B01001_034",
                                   female_25to29 = "B01001_035",
                                   female_30to34 = "B01001_036",
                                   female_35to39 = "B01001_037",
                                   female_40to44 = "B01001_038",
                                   female_45to49 = "B01001_039",
                                   female_50to54 = "B01001_040",
                                   female_55to59 = "B01001_041",
                                   female_60to61 = "B01001_042",
                                   female_62to64 = "B01001_043",
                                   female_64to66 = "B01001_044",
                                   female_67to69 = "B01001_045",
                                   female_70to74 = "B01001_046",
                                   female_75to79 = "B01001_047",
                                   female_80to84 = "B01001_048",
                                   female_85_up = "B01001_049",
                                   total_white = "B01001A_001",
                                   total_non_citizen = "B05001_006",
                                   median_income = "B06011_001",
                                   median_household_income = "B19013_001",
                                   total_families = "B17010_001",
                                   families_below_poverty_income = "B17010_002",
                                   single_father_young_children_under_poverty = "B17010_010",
                                   single_mother_young_children_under_poverty = "B17010_016",
                                   single_father_young_children_above_poverty = "B17010_030",
                                   single_mother_young_children_above_poverty = "B17010_036",
                                   housing_units = "B25002_001",
                                   vacant_houses = "B25002_003",
                                   male_16to64_in_labor_force = "C23002I_004",
                                   male_65_plus_in_labor_force = "C23002I_011",
                                   male_16to64_in_labor_force_unemployed = "C23002I_008",
                                   male_65_plus_in_labor_force_unemployed = "C23002I_013",
                                   female_16to64_in_labor_force = "C23002I_017",
                                   female_65_plus_in_labor_force = "C23002I_024",
                                   female_16to64_in_labor_force_unemployed = "C23002I_021",
                                   female_65_plus_in_labor_force_unemployed = "C23002I_026",
                                   total_commute_to_work = "B08126_001",
                                   total_walk_to_work = "B08126_061",
                                   median_age = "B06002_001",
                                   pop_over_25 = "B06009_001",
                                   less_than_hs_grad = "B06009_002",
                                   hs_ged = "B06009_003",
                                   bs_degree = "B06009_005",
                                   grad_degree = "B06009_006"),
                  state = "NY",
                  survey = "acs5",
                  year = 2019,
                  geometry = TRUE) |>
  transmute(GEOID, NAME, variable, estimate)

census_ny_zctas <- get_acs(geography = "zcta",
                     variables = c(total_pop = "B01001_001",
                                   total_male = "B01001_002",
                                   male_18to19 = "B01001_007",
                                   male_20 = "B01001_008",
                                   male_21 = "B01001_009",
                                   male_22to24 = "B01001_010",
                                   male_25to29 = "B01001_011",
                                   male_30to34 = "B01001_012",
                                   male_35to39 = "B01001_013",
                                   male_40to44 = "B01001_014",
                                   male_45to49 = "B01001_015",
                                   male_50to54 = "B01001_016",
                                   male_55to59 = "B01001_017",
                                   male_60to64 = "B01001_018",
                                   male_65to66 = "B01001_019",
                                   male_67to69 = "B01001_020",
                                   male_70to74 = "B01001_021",
                                   male_75to79 = "B01001_022",
                                   male_80to84 = "B01001_023",
                                   male_85_up = "B01001_024",
                                   female_18to19 = "B01001_031",
                                   female_20 = "B01001_032",
                                   female_21 = "B01001_033",
                                   female_22to24 = "B01001_034",
                                   female_25to29 = "B01001_035",
                                   female_30to34 = "B01001_036",
                                   female_35to39 = "B01001_037",
                                   female_40to44 = "B01001_038",
                                   female_45to49 = "B01001_039",
                                   female_50to54 = "B01001_040",
                                   female_55to59 = "B01001_041",
                                   female_60to61 = "B01001_042",
                                   female_62to64 = "B01001_043",
                                   female_64to66 = "B01001_044",
                                   female_67to69 = "B01001_045",
                                   female_70to74 = "B01001_046",
                                   female_75to79 = "B01001_047",
                                   female_80to84 = "B01001_048",
                                   female_85_up = "B01001_049",
                                   total_white = "B01001A_001",
                                   total_non_citizen = "B05001_006",
                                   median_income = "B06011_001",
                                   median_household_income = "B19013_001",
                                   total_families = "B17010_001",
                                   families_below_poverty_income = "B17010_002",
                                   single_father_young_children_under_poverty = "B17010_010",
                                   single_mother_young_children_under_poverty = "B17010_016",
                                   single_father_young_children_above_poverty = "B17010_030",
                                   single_mother_young_children_above_poverty = "B17010_036",
                                   housing_units = "B25002_001",
                                   vacant_houses = "B25002_003",
                                   male_16to64_in_labor_force = "C23002I_004",
                                   male_65_plus_in_labor_force = "C23002I_011",
                                   male_16to64_in_labor_force_unemployed = "C23002I_008",
                                   male_65_plus_in_labor_force_unemployed = "C23002I_013",
                                   female_16to64_in_labor_force = "C23002I_017",
                                   female_65_plus_in_labor_force = "C23002I_024",
                                   female_16to64_in_labor_force_unemployed = "C23002I_021",
                                   female_65_plus_in_labor_force_unemployed = "C23002I_026",
                                   total_commute_to_work = "B08126_001",
                                   total_walk_to_work = "B08126_061",
                                   median_age = "B06002_001",
                                   pop_over_25 = "B06009_001",
                                   less_than_hs_grad = "B06009_002",
                                   hs_ged = "B06009_003",
                                   bs_degree = "B06009_005",
                                   grad_degree = "B06009_006"),
                     state = "NY",
                     survey = "acs5",
                     year = 2019,
                     geometry = TRUE) |>
  transmute(GEOID, NAME, variable, estimate)


# save as .RData
save(census_ny_tracts, census_ny_zctas, file = "data/ny_acs_master.RData")

